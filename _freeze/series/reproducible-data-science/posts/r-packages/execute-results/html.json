{
  "hash": "94be81771c69f9ff4acf28e7bf8f33d2",
  "result": {
    "markdown": "---\ntitle: R Packages\ndescription: Installing, managing, and finding R Packages.\n\norder: 4\n\nparams:\n  year: 2022\n---\n\n\n## How do I install R packages?\n\nThe standard way to install R packages is with the `install.packages()` function that comes with base R.\n\n```r\ninstall.packages(\"tibble\")\n```\n\nA fresh way to install R packages is with the `pkg_install()` function from the **pak** package.\n\n```r\npkg_install(\"tibble\")\n```\n\npak is fast, safe, and convenient. You can learn more about it on the [package website](https://pak.r-lib.org/).\n\n::: {.callout-note}\n## \"Do you want to install from sources the package which needs compilation?\"\n\nWhen installing a package, you will sometimes encounter the above question along with the message \"There are binary versions available but the source versions are later\". What this question is asking is whether you would like to have your computer build (compile) the package binary from source code then install it (`yes`) or have your computer install a pre-built binary (`no`). If you choose yes, you will get the newest version of the package; if you choose no you will get the newest binary version of the package (typically the previous release).\n\nUnless you need the newest version of the package for a specific feature or bug fix, I recommend choosing no---the binary version will install faster, and you can simply wait a few days for the binary of the newest version to be built on the repository you're installing packages from, then install the package again to get the newest version. If you need the newest version of the package *right now* then choose yes, but you will need to set up your [R build toolchain](https://r-pkgs.org/setup.html#setup-tools) first.\n:::\n\nTo learn more about package installation, see the [Package structure and state](https://r-pkgs.org/structure.html#package) chapter in *R Packages* by Hadley Wickham and Jenny Bryan.\n\n## Where can I install R packages from?\n\nRelease versions of R packages can be installed from:\n\n- [CRAN](https://cran.r-project.org)\n- [Bioconductor](https://www.bioconductor.org)\n\nDevelopment versions of R packages can be installed from:\n\n- [GitHub](https://github.com)\n- [R-Universe](https://r-universe.dev/)\n\nPrevious release versions of R packages can be installed from:\n\n- [Posit Public Package Manager](https://packagemanager.rstudio.com/)\n- [~~MRAN~~](https://mran.microsoft.com/) (shut down on July 1st, 2023)\n\n## Where can I find new R packages?\n\n\n::: {.cell hash='r-packages_cache/html/cran-bioc-runiverse-pkgs_8602e0c057211b00a3a51796d2ba8eb3'}\n\n:::\n\n\nThere were 18954 R packages available on [CRAN](https://cran.r-project.org/web/packages/) in 2022, and that number only continues to grow over time. That’s not to mention the 2165 R packages available on Bioconductor, the 1704 packages available on R-universe but not CRAN or Bioconductor, and the unknown amount of packages only available on GitHub.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](r-packages_files/figure-html/plot-first-published-1.png){width=672}\n:::\n:::\n\n\nFortunately, there are many places to find curated content about R packages:\n\n- Your favourite search engine\n- [CRAN Task Views](https://cran.r-project.org/web/views/)\n- [R Views](https://rviews.rstudio.com) \n- [The Posit Blog](https://posit.co/blog/)\n- [Posit Videos](https://posit.co/resources/videos/)\n- [tidyverse blog](https://www.tidyverse.org/blog/)\n- [Trending on GitHub](https://github.com/trending/r?since=monthly)\n- [pkgsearch](https://r-hub.github.io/pkgsearch/)\n\n**Your favourite search engine** is often a good starting place. Include `r` and `package` in your search, plus the topic you're interested in, and you'll usually find something helpful. Use boolean operators to narrow down your search or to hide unrelated things like Reddit (`-site:reddit.com`).\n\n**CRAN Task Views** provide guidance on which R packages are relevant for tasks related to a certain topic. The task views are not meant to endorse the \"best\" packages for a given task; rather, they take an encyclopedic approach that serves as a good reference.\n\n**R Views** is an R community blog edited by Posit where you can learn about new R packages and see how to use them (plus some other goodies).\n\n**The Posit Blog** is where you can get news and updates about R packages made by Posit. The blog is about \"all things data science and the world that benefits from [Posit] products, community, and events\", so it has a wider scope than R packages alone; but it's a good place to follow anyways to stay up to date with what's happening in the R world.\n\nOn a similar note, you can find videos from events hosted by Posit, such as conference talks, data science hang outs, tutorials, and more at **Posit Videos** (and the [Posit YouTube channel](https://www.youtube.com/channel/UC3xfbCMLCw1Hh4dWop3XtHg/playlists)). This is a good place to see what R packages the community is using, and how they use them.\n\nThe **tidyverse blog** is where you can get news and updates about R packages in the tidyverse.\n\nFinally, if you don't want to leave the comfort of your IDE, the **pkgsearch** package is a package you can use to find other packages..!\n\n::: {.callout-tip}\n## Social Media\n\nWord of mouth on social media is a great way to find new packages or learn about new ways to use your favourite packages. Follow your favourite developers to keep up to date with their work, and check out the *#RStats* and *#TidyTuesday* hashtags to see what the community is up to.\n:::\n\n## How do I attach R packages?\n\nThe standard way to attach R packages is with the `library()` function that comes with base R.\n\n```r\nlibrary(tibble)\n```\n\nIf you want to attach multiple packages in a single function call, use the `pkg_attach()` function from the **xfun** package.\n\n```r\npkg_attach(\"tibble\", \"dplyr\")\n```\n\n### How do I manage namespace conflicts?\n\nSometimes R packages will use the same name for different functions. A common example is `dplyr::select()` and `MASS::select()`. Under R’s default conflict resolution system, if both of these packages are loaded in the same session `select()` will come from the most recently loaded package.\n\nIf you want `select()` to refer to `dplyr::select()`, base R provides the following solutions:\n\n- Load MASS first and dplyr second\n- Exclude `select()` when loading MASS: `library(MASS, exclude = \"select\")`\n- Always namespace dplyr's `select()` function: `dplyr::select()`\n\nAn alternative approach to managing namespace conflicts is with the **conflicted** package, which makes every conflict an error and forces you to choose which function to use. You can learn more about it on the [package website](https://conflicted.r-lib.org).\n\n## How do I update R packages?\n\nMost R packages available on CRAN are actively maintained and updated. For example, in 2022 more than half the packages available on CRAN had an update in the same or previous year. It's good practice to keep up with these updates so you can get the latest features, improvements, and bug fixes.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](r-packages_files/figure-html/plot-last-updated-1.png){width=672}\n:::\n:::\n\n\nUse `old.packages()` to check which of the packages you've installed have updates available from the repositories listed in `getOption(\"repos\")`.\n\n```r\nold.packages()\n```\n\nUpdate specific packages to the most recent version by re-installing them with `install.packages()` or `pak::pkg_install()`.\n\n```r\n# The standard way to update a package\ninstall.packages(\"tibble\")\n\n# A fresh way to update a package\npak::pkg_install(\"tibble\")\n```\n\nUpdate all the packages listed by `old.packages()` at once with `update.packages()`[^2] or `pak::pkg_install(old.packages()[,\"Package\"])`. Note that `update.packages()` uses `install.packages()` under the hood, so it won't be as fast as pak.\n\n[^2]: By default `update.packages()` will ask you one by one whether you would like to update a given package. Use the `ask = FALSE` argument to update all packages without asking. \n\n```r\n# The standard way to update all packages at once\nupdate.packages()\n\n# A fresh way to update all packages at once\npak::pkg_install(old.packages()[,\"Package\"])\n```\n\nYou can also install and update packages using RStudio, either from the **Packages** pane or from the menu bar **Tools > Check for Package Updates**.\n\n::: {.callout-warning}\n## Breaking changes\n\nSometimes package updates will include breaking changes, which are named as such because they are expected to break code using older versions of the package. Most package updates won't contain breaking changes, but occasionally they will. This should not discourage you from updating packages, but it should encourage you to update thoughtfully---don't do your updates before important deadlines!\n\nI recommend creating multiple user libraries with **rig** that can be used for different tasks. This way different libraries can be updated more or less frequently, and it's easier to make the choice whether or not to update. For example, you could have a `devel` library for package development that is updated weekly, a general `main` library that is updated monthly or yearly, and so forth. Another good practice---especially for long-running projects---is to create project-specific libraries with **renv**. The project libraries created by renv are isolated from your user libraries, so you can continue to update your user libraries as normal without worrying about breaking changes affecting the projects using renv.\n:::\n\n## How do I restore my current library into a new library?\n\n::: {.callout-caution}\n## This section needs to be tested\n:::\n\nA new library is created whenever you install a new major or minor version of R (the \"x\" or \"y\" in version \"x.y.z\"), so all your favourite packages need to be re-installed to this new library if you want to use them. This is also true if you create a new library in the current version of R (e.g., with `rig library add`).\n\n::: {.callout-tip collapse=\"true\"}\n## Transferring a library from one computer to another\n\nThe approach shown below can also be used to transfer a library from one computer to another. All you need to do is:\n\n1. Follow the steps to create the character vector of packages in your current library (`pkgs`)\n2. Save the `pkgs` R object with: `saveRDS(pkgs, file = \"pkgs.rds\")`\n3. Copy the `pkgs.rds` file to the other computer\\*\n4. Load the `pkgs` R object with: `pkgs <- readRDS(“path/to/pkgs.rds”)`\n5. Install pak on the other computer with: `install.packages(\"pak\")`\n6. Install the packages with: `pkg_install(pkgs)`\n\n\\*For added convenience, store `pkgs.rds` in a GitHub repository so you can access it wherever you go!\n:::\n\nIf you are using **rig** (and you should be), restoring your current library into a new library is easy with some help from pak and dplyr.\n\nFirst---in your current library---get the path to your user library. Copy this down somewhere.\n\n```r\n.libPaths()[1]\n```\n\nYou can now switch to your new library. The easiest way to switch on macOS is with the menu bar app; otherwise use the shell prompt. Open a new RStudio window to start a session with the new library.[^1]\n\n[^1]: It's okay to keep the RStudio window for the current library open.\n\n```bash\n# Switch to a different R version\nrig default <version>\n\n# Switch to a different library\nrig library default <lib-name>\n```\n\nIn your new library, install and attach pak and dplyr.\n\n```r\n# install.packages(c(\"pak\", \"dplyr\"))\nlibrary(pak)\nlibrary(dplyr)\n```\n\nUse `pak::pkg_list()` to get a data frame containing data about the packages installed in your current library.\n\n```r\npkgs_tbl <- pkg_list(lib = \"path/to/your/user/library\")\n```\n\nWrangle this data down into a character vector specifying the package source and package, following the [package reference syntax used by pak](https://pak.r-lib.org/reference/pak_package_sources.html#package-references).\n\n```r\npkgs <- pkgs_tbl |>\n  select(package, remoteusername, repotype) |>\n  mutate(pkg = case_when(\n    # GitHub\n    !is.na(remoteusername) ~ paste0(remoteusername, \"/\", package), \n    # CRAN and Bioconductor\n    repotype %in% c(\"cran\", \"bioc\") ~ paste0(repotype, \"::\", package),\n    # Default to the `standard` package source\n    TRUE ~ paste0(\"standard::\", package)\n  )) |>\n  pull(pkg)\n```\n\nThen install all your packages.\n\n```r\npkg_install(pkgs)\n```\n\n::: {.callout-warning}\n## Default library locations and .Renviron\n\nIf you have previously set `R_LIBS_USER` in your `.Renviron` to change the default library path, you may need to remove this variable or change its path if there are issues locating your various user libraries. A quick way to open `.Renviron` is with `usethis::edit_r_environ()`.\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}